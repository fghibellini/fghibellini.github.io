<!DOCTYPE html>
<html>
    <head>
        <!-- SHARED CONTENTS OF HEAD TAG -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Personal blog">
<meta name="author" content="Filippo Ghibellini">
<title>Filippo Ghibellini - Max area under histogram</title>
<link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,700" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
<link rel="stylesheet" type="text/css" href="../../css/default.css" />

        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.min.js"></script>
    </head>
    <body>
        <div class="post-nav">
            <a href="../../">&lt; Back home</a>
        </div>

        <div class="content">

            <div class="post-header-image">
            </div>

            <h1 class="post-title">Max area under histogram</h1>
            <span class="posted-on">Posted on June 26, 2015</span>

            <h3 id="preface">Preface</h3>
<p>While in university I came across this problem which had, in my opinion, a very elegant solution (even though algorithms definitely weren’t my favorite course). It was also one of the 2 instances I remember using property based testing felt really rewarding.</p>
<h3 id="introduction-to-the-problem">Introduction to the problem</h3>
<p>A histogram is what most people call a “bar graph”. It is a graphic representation of a sequence of numbers. What we want to find is the rectangle with the biggest area we can fit in it.</p>
<p>More precisely we want a function that given a sequence of numbers returns a set of pairs where the elements of the pair are respectively the start and end index of the maximal rectangles (there can be more than one of the same area).</p>
<h4 id="example">Example</h4>
<p>Given the histogram <img alt="h = \{ 3, 1, 1, 5, 7, 9 \}" class="math inline-math" style="vertical-align: -5px" height="18" width="130" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQMAAAAkBAMAAAB/IULCAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVLvN7yJEiRAyq3aZ3Wai9PbOAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEUUlEQVRYCe1XTWhUVxQ+kzhv3vwlg7gogmT6gyJUMv60SKnM1BQ30maq2FUl02K7qGCyEUSEPIoLcTPZFULRETdShJlFC10UMiCliy4mrUJR0AzaRTeSaeN/f17POffdv+fLyyR2JZ7FvefnO+d+775z75sBeCH97UD6ys/9AVeHuvOr13dC81Lf0FUBD/yt4Ot39ZQeoeQ0MiL6LK5yS2Z/OFqSatQ8fJ+9H72yo2CGD1dNCyzz9Zfgg8sqfHtGqaxkd/5SY2VyXgWmp5QaoUz0yDm0FbJLngonN/pVZQCEzLLv+0UVnkbL9x9JO33Dcx6yMVGRPijXlBqhCAqfYETvlvveBZNCyISy77+vK40yhbZ0TJQARrpkicrs93lcbhDAJu7UnHglAmhSQI9l7j73qVHt1mcod5SDHniYd1ZTcJZUOEoRwDImTf5hxK01wxQMHAA+NcAb0uXQAw/8S6amkBJvRmLCswBuauH2PTZifVNITmFWriBTU0Qh9SeZmsLgAxmOnDWwM28A+qYAHmZtVJmZe6hmaTAo1HuzX7+pIE8pioLrzxjBWAqJU78bUDwxJWUyhSHfQ4eqDCNbWjBtVldwVhTw4HUzEEdh++Yz39RM8KC2xIvgbFUZOu8AnG+LjOQhKVXhwFCFtew2u2XiKOzArTZbF27LYgBp2oAB3tB6T7oX2rhOUVh1PsM0qBKLQQhm9wuMGOMo1BDCb1sm7JMKzs0CwGmmsE42oUstutg2QJbqjqt31CkakTgKBNMfANwS9bgYOF0C+ImzE/94hARI0AEhapHi/qY7oG5+sFai0CzqenlcVYn76sxXx7gdYcOtKrtzf+E07imIrdxdEijy5s1rdCUKnYouJDtNeNLffycOJaQXtrMr/xjA4atC5xjaWe5C56onmyiIxVA4TA/d6eki012ts5Z7whPd+iT1CkCGL0w0Ik7EaAv9Gb9AFDxUA4mhsEht1qxIJO4xJluS50bMyTM20uDPBo4oESdisoL+FK2YN7s8hsKRBmaU2zgIcf2aVHH+0sNLaZ4cwS8R3LEufoAaboOcUcIXSJpyJqhrpMRQGESMa8Qdi8JCG9ecoTLqahrH55srpNhJgbAI4I/obpYABuUrE0uUuwHcNIdawasNoglxswep5QI44lkkhSTt7mTtaFDq6UkAc5sh98RD5sGpSPi4DiT9nkiwzZPVZLOrowGFIPXzqjuHQRRJwaU7L/UWFYyWADi7Z28BAQNjVYJdG/fvvYvza+J3QMh0Lo6dIFQQdcfIkKnpbTd/YFtREFbMKLkGkCxTUPhvlcZKrBlKXTOFlL3m1CrMUOqaKWTsNRurMEOp/VPQn1Re7WNrTYf6Q0u8aafqdtT5y2jDj8yAWzQt+MKy4s1QKp7Dip29rJWR1ygjUnY3HrfTYs1QKv4vCTWSXcu0RvmAmZ7/Rzf+1q5UMH3l5ZUga4nffdve0LXUeH5y/gNxZnhhTpx11AAAAABJRU5ErkJggg=="> we want to get back <img alt="\{ (4,6) \}" class="math inline-math" style="vertical-align: -5px" height="18" width="52" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAAkBAMAAAB4agm7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMpnN3VSrECLvZruJdkTbkwyAAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACjklEQVQ4Eb1VO2/TUBQ+cRKnxY4d8QdiKTNSVcGChCgCBhBSK1EJMZGNMZ6QylKviIFIqCBTRJHowpQOMLRLAhJig/AHoAsjSqBFUF6X87iOr2MsJvBwzne/c757bs59BOB/f6XWWS5pRQWVa20OPLoQGgmdqzLYMbgsvCjDm59S2tLYaqfcFHJ16ORwEvC/ClzWzJFJBMHh0/O0rOPCjRbEo701Frgmzvs5iQBYD8Cbw/GIpJjaZcdQVK5mZk3VdgjOZ0yqBJyeFMCBhv6QA9AyVO4vAP8b8tUvBapeyAHvuaFqzqGAZxMyX+uolHIsQ9XR9QGeFNTS/X9mqlRDpgJ4HRHK1fLoRwOUBobKU/DhRcj8aIlcTlWXXXPAULnKunT9HqtWgylVs0uELV16ZaqsgzcAVwYU9rfIro7J8tdjosxEKTBVtgoAyh8pa3aBLe6EfLWNBoEKqxw8DmkPbbUL4O5xuEu2uh+SA6g9PsW+wvTbjMpSmHSIDMhS4PL5iLM398SzaibIqFyFKVVuv1aVFo+xCq79YM8rdHBaY4XVVCVLgc5ARAD9ISGe7EYcxxsqbuvQjIqSFUo3LKlA4VGXrO48ytNuwOIuQH2fwtL55CoiIRvu6ruZUfVwGWU+NH5A2tzZ0CcKs2gVZboe6O4CNLcIjR6SzalqyUuy8p3C1AfcljMN7w6jdxG5nAr0TdlWKh6Cc5uzoH5ufYnSC2+KvpWcgz2INNDuPvt8reQFkDQ3Kyp8AVzegCTZToD4cpu9USs5/muSIPa9OUhftvGE9uVmwfKEweZxu1PihEA5EIxtfUzMF9uNUgWi5MXuD1K6/1LwTkpNoT/8O0Cp9ZSz/vZPtDkfTc3274e/AXme06bY5pB5AAAAAElFTkSuQmCC"> since the rectangle starting at position 4 and ending at 6 has 3 bars: <img alt="5, 7, 9" class="math inline-math" style="vertical-align: -4px" height="15" width="40" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAeBAMAAACfyF7nAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAu5lUECKrze9mMkSJdt0FgqyLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABwUlEQVQ4Ea1SLU8DQRCdtnfdwLVQj2gTFCGEYqoQhyVpqMKCoJoaEkIIqQKBoFUIQoAfACWBYBCtwB8O2QRDMHwTvgLHzH7cTk8hGPH2vTevs93dA/h7JYZ9t1SI8s39iEpytTakDRGG4aNtBijD8MUYRwvQ7iiBwfeG8QHyMljQhvsGkPrQwemdis3B7TnWtjHEF7JQB33jyrVGuGSs9gOyvNpQ+Mal1e0gJItEqQIKBjnJe4Pgo1mSDYLFOkKXAED4kyO+ZAbcmmEquKfuQEycljejDhFxHEm19avUAv9Btxi1kDStaNGw/Kc0PMTBuqQa2Pz0M4CzpYLUFd8smH2wwtnAO+iqrclNszeEgZoNwtRK/6g+DLnJd9ZrFZiAwzFfXY97Q0H9SjIRNHgQ+fg8GX3hMW7NJ24VyWd1jwkAbx1BPFnfoV+a6r/AV/1RqobLjD0XeDw4gBOS+nZ2MbjYwKn6s0uF+zRBSYH32L4kDZCpwixl5vSBdFBJrwplPQDgbHnVx2Bio4KID4F3jKXlwd21sqWpINvrxCQLZhhHGpOsmWYcaUyy5gnjSGPSNp2c5chikvUyvWeJSRb8J/oLP1p5JfZCmrcAAAAASUVORK5CYII="> giving it a width of 3 and a height of 5 that is an area of 15.</p>
<h3 id="formulated">Formulated</h3>
<p>We will work with the following definition of <img alt="\mathcal{H}" class="math inline-math" style="vertical-align: -1px" height="13" width="16" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAaBAMAAAC9TZq5AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMARJndu80iie9UqzIQdmbBcfWkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA7UlEQVQYGY1QS1LCUBAckghWyKekirWeQL1BuEFcmHVyg3gDsmHBgvIIZOMaboBH8AZ4BQmo/BxmehawtBfdPf1m6s17RP9CL1mhzxlYe79JuFCbviBwxuTzXGxgMaUFhfwuQbhBQ+dI5LBaV5yglEEPZ+UBQSDs7tQOnxAoxX/KyYcysPgWaeMqC5aVaPhrhfKsFvJsXXHtNx5lWZZvxQMlA692q0Zho/zwqAx4Pyr5HQqleK/Mn8rAtBLpXqwxk+dQhAeigXDmnPdqwV7Zb2iLjxWv1xR92UQMjbm4rS2YQl3midV0A20936ueAIikRMhisuGvAAAAAElFTkSuQmCC">:</p>
<p><img alt="
\begin{aligned}
    allRectangles = &amp; \{ (x,y) : x \leq y \land x, y \in \{ 1 \dots n \} \} \\
    area(r) = &amp; \alpha \cdot (y-x+1) : r = (x,y), \alpha = \min_{i \in x \dots y}(h_i) \\
    maxArea = &amp; \max_{s \in allRectangles}{area(s)} \\
    \mathcal{H} = &amp; \{ r : area(r) = maxArea, r \in allRectangles \}
\end{aligned}
" class="math inline-math" style="vertical-align: -50px" height="109" width="452" src="data:image/png;base64,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"></p>
<ul>
<li><img alt="\boldsymbol{h}" class="math inline-math" style="vertical-align: -1px" height="13" width="12" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAaBAMAAACwU+r+AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAds3d7xCJuyJmMqtEmVQDyUFZAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAtklEQVQYGWNgwA+EjP0DECqS/v9HcBgY/L8j8Tj+f0Ticf7/hcTj/v8BicfyvwCJ1/9fAIk3//+JK180YQL7/+ffW/t/A5Tr/9+DgQFmLsf/LwFA3k+IHOf/fwwMXP//QHhg6xj/f4XwwNYx/VeA8MDWxcPslP/fwMAg/z+AAyxZ/wVI2X9nkAeaDPTdbwYGHqCR5iAOF8gCvv8fGH+AeHwgs1n9vfIPgHisKhOAZLd/FYiDBwAAn7pBR49bD+0AAAAASUVORK5CYII="> is a histogram represented by a sequence of <img alt="\boldsymbol{n}" class="math inline-math" style="vertical-align: -1px" height="9" width="14" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAASBAMAAABY9biuAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdt3vu0RmzZkiiTJUqxAp96ciAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAqElEQVQYGWNgIAAYlV0Z2Oo/dUKVLQr5n6mUffjzBDCf8yvjf3sBBo7/DWAuhwHv/48MQK4CmMvcwPy/gIGB/b8DmMvJMP9/AgMD//8FYC4DQ/5/oCnn/2+Acu9/AjL8P0N5DPY/GBj4/v9ieAAW4P7/h4GB8f9PBqD5QMD4/x8DA9N/B7afYC4LyB7m/wmTF4C5QBYDA9d/GV0wj4HRBEQnfRKAcPGQAHySMutnVwSvAAAAAElFTkSuQmCC"> natural numbers.</li>
<li><img alt="\boldsymbol{allRectangles}" class="math inline-math" style="vertical-align: -4px" height="16" width="114" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOUAAAAgBAMAAAAfwqIiAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAEHbN792JMmZUqyKZRLvO4q2FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEmklEQVRIDeVWT2ibZRh/vjRJsyZtgx48eEiobCA7tIzuMBQSWSso4rdD9SCTBMRdFFoQpMVBIzJ2EEwPFS9Cc9lpSKMMdMhoYDsoKu3Nw6QpHraTpG2Sbto/z36/9/2+L2mSFSnUi+/hyff8+f3e93ne53lbkf/hCp2fekXESompWZN/lo9dCY/pSHw0o1kRKyV+pqY7V67c0IPem44cSWWcHtPRgWEtIcBKkWndgFZU5N69hrTQbey0+Eyd9nZ9xRBZKZLRNJx9utce4n+njNPXnvLrMz3FbcxFZR2tFFGdgTak9V6QJePs5Wmz+Uxtpq7P5QZNVsqgKrWwHvCnc60aZ6e1Q/eYOqyHVfcf6lZK1G42r38fDrJarudJOiI9pg7rITWuj6FbyYvcpnfZdNKhOCiO7nSaunWfqdsj8sx4Mz+bFIzkLtxWigx7mk3o66nmLwb78XjzpuNydi9B96Ghqb8klvFCnM/cN57/tMUUYL9wLxYMiYT0wuwkp2SA4+lJkSo054daswCbLOpvsy5b6iP9Zi43M3Jat0cW8H740PfX9fO3ri82ygwuNr/60kXnWb4W9tm9+394Q7CMW1zRMX8w/aGaNu/QwRpZBvQlHKIickr3pT+3IRFbcR8a3w+pm5aEIgRyQxwX7WiZAqzUCvAhgCFZFjLPjQvQ/aHK6Nkfb2fsGK42ktizJLKkC9hvTFLGHkAT2QHefsLUe5QTx/axTAG2H/ul7J5VwquKfEywJzmegEZM1w6S0Mmsob9wu2EA7HgG0HAlzEL1Mfs4HxHTPoYvwEoIuKHXkBWfmyTfOXzVmtSt9MYzYV6EiG7JndXHrPG+yODPInY8A2jc5mSqNaCP2D5bHlOAxb3oy+gsrLhypwzOL665YCtxKprsniu42sYDHC1lugz2HJ1tUPt4meyHGTPEKhumAIszgKYAHE7ESWPx+k0drSSK4xlR3AsqefNb/PCjYn4d42xBMcY8eY3vWFVLrH/F4wuwKNBdlzXAny7uNIjvcki3nBnkR8muojtlTlRE55g1as+JMu2KzLSgNic+FElknBaZB8IyBVjn17LEl5kIPIBHdTO6iXoksqwKJFGbkEt8mspV/0Ef9T7YsAPZFtTmRH0bkDW2Y9JjCrAR1mgYCTJFcKPhIiWMUziPqlASNQZZRNMksimzVX8JBynD6OQjqF+10IIyJ17ERmwX3YQYNqJlCrArrNFKFni0A/Jc1vx8uU/T1SS2p+SF5yH5ws/no+a7OIajp2FcvNSn+fjrbVA4cMKwFm7lQbBgm8QyBdhh9g2eBa5b9d+vvaoPL+OSHr7Nl4byuzOqD86y6PW5N3Gmvftz94BxMjufzN3bY9BopQ3K7Rj84juIyb17O8OZskwBNla//v1p3BSX897EOVlv5kXWJ9PQjZzWiQnzV+Zqrg5j/K7b/InZn7qh5mPdvQCtBQ3hYCLXmmnI2PjFD00zWL4Ae3WqcY4cJ7T6TDOcEHkP2udgS5kG6OE8GdMgU7Qv98ls0IN1CKPb/2/+i+iBPa4poR/cWW0sHBd+PNwLbuPyf7zl8Q560qgntG+Vi46GPeUAAAAASUVORK5CYII="> is a set of pairs of numbers <img alt="(x,y)" class="math inline-math" style="vertical-align: -5px" height="18" width="38" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAAkBAMAAADRHsEvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAmSK7ZqtU3e+JdhDNRDLOeD1IAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACBUlEQVQ4Ea1UTUvcUBQ9kxhnXjJj7Fqq2VSXTkvFpf6AQgfBnS2z66agW6HggLRQqrR/oDgL9wb8AbqQFrrqorodoT/AVrQFbR3vPXn5mCGFUvog95577sn7uLkvwP8flehPcwatQuZhAQ/B53lcKb6S00Qmzz0bSg2ER1n0KkMloBdb0nRKshlVHbcw7GZcCRi9tuTjdNoSkVBXlv5Ynk7ZeQu+p0S534nIN37Q3Vt5Fyx/yJRmpQv4byTutUn65+qcB1jfj1cjUmLej94ANd3+QXJUj0epx5h64vQ/W1mj68vWz9YkDJvk6t/U7QI7h8EmGTFu7P4G9sYF1lQLVCk7BBYWNUyGh4OOMG2JqgIyFwN9efKhM5FJVkvVaPzKNYI2TjH2U5lUxkUBk5abakckPitqF7VqVFkYasSMiMRlRe0RkoIAsx1gKVWhIpKQpbIFMTqLv42pJgqd70k9WDaEchYZ/FjhBebX4Eay4wuyvsy2QEFvkUSgG621zPQ57gqa7ZN1XsJ721a4F6kFtJHG5p7i0fKpIHcrEgt8vT+ZFDJtpKG29BOZ7OaS+te0cqCuBYkzdF9kXukRIGvyoSvjabIhC561FNVpFQ1ewBOlRi4RvFCAXkwnZuA6B02lnRZmJpj/RKtm4OdgIvLHdybpTbYm8He/GlQivlliCp+vJPuP1C19pm8Yi+KF/AAAAABJRU5ErkJggg=="> where <img alt="x" class="math inline-math" style="vertical-align: -1px" height="9" width="11" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAASBAMAAACtCzMeAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAIqvNiRBUu92ZRHZm7zLwagrxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfklEQVQIHWNgwA2ElB1YlczA8oyFDC3hAfkCIA5zAMN8Lcb/C0DsPQwM/gas10FMBgMGhvoDYBYDQwADw38ghgKuzzAWAwPLbwSb4yOCLX+BgUERxOW+xTC/gIFVAcTm/8NQ0cDALgBi8yqwiH1kmAViMvAV6TEcVnoAZmMnAKBiF029grzYAAAAAElFTkSuQmCC"> and <img alt="y" class="math inline-math" style="vertical-align: -4px" height="12" width="10" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYBAMAAAAIZcBFAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAiavNdu8QRFQy3buZImY1ooPAAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoUlEQVQYGWNgwAEYlR0YGFjCQLLiHD8ZGFi/AVnsDixfGBjmLwAyuRO4vzMw+B8AMpkY8gMYGPY3AJkQkf8JYOb6CQycv8AsXiDF8gfM5ANS3D/ATB4gxQ8yFmgE0CywsUB1QNH9B8CivEEMTPENYCbD7D0nocYC+eyfIIJ1QLOAbgOJACXnK4CZfJ8Y2BaDWQy8Cgy3jkGYDEVnTkJZ2CgA2cMoKFSLrxoAAAAASUVORK5CYII="> are respectively the start and end index of a rectangle.</li>
<li><img alt="\boldsymbol{area(r})" class="math inline-math" style="vertical-align: -5px" height="18" width="62" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHwAAAAkBAMAAAC57UMXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAEHbN792JMmZUqyKZRLvO4q2FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACaElEQVRIDdVVu24TQRQ9fmLHNrHgA8gXEBSlgMpGgoBAwi4oLcUI0WKJKqJxEFAHiRYp+wdxgUQBEktBCUqXBsVuEBWKwTERIeFyZmc9O7NF1iE0TLG+53E9d2bu7AL/zbgfVZryonjKqHzTMj634unCzqbly3sWmCZM/3BcFx2UDLp1x9OvOjAR7Mw5lpzvwCRQEXe64rekDEfPHTgQ+B7DR8Puz5j+OYaPhvO/YnqnFxJnFsftFa4sffsrHu++U2zxfaMVyBMNtbriLUv/mSJIyaWVq+IB97bl/PUH+6SKjYOtJ3u2lpIBoWXBOV8RwAYT3soFlA7TMqqui6JGPVTUXk00nBKf0LJgdkACKEsdmJU2ys0ZhrWxoi4DFf6r0VCkgdhYgGyTBNCXOfXYRNbPcglr10Lq7KGloaBclgXI1UkANdUPHZZc4hJWA2pZqqVPKjYa8oEUWYDMUHlLwmpR+63iNempn5Jw3LrjaDrdWOjS6QVRN0mCHtrZVdlc5/5rVgRWbDRdPBBaKOri88J2qsgeOLGoQ1NZYYdZmt46Y6FLb11a2E55GeaHPBydpv4sGI7mK2piYagPriLcgowMch77R9+ilE5/yKKMFrbNxKLSfT6AZc6+Ie1uD6elGTDoqCUXRrYWNq2x8FBXA/PL0dbTJfnS4mqC1iA5Ix9evWi0gUiDvjLGAsxzszhSd68sYHtMc/pGQPDxZlFajxwN+sJGFhzvwub0qUwmAJaicIqoeLKXFWKvyow3xZyWpVu3ADe+6sBEEPtMLCQmxAwn+0ihzHeIGcf/ROKjScZffKCj5H8V/QEg1hRQ4wZ7HgAAAABJRU5ErkJggg=="> is a function that given an element of <img alt="allRectangles" class="math inline-math" style="vertical-align: -4px" height="16" width="97" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAAAgBAMAAACyQ7qLAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAZrurVHYizRCJ7zJEmd3lJ8DAAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEdklEQVRIDd1VTYhbVRT+8vPevPQlM1FBoSB5ErVS1AkTi8V2zMWibgoJWkGokEEXQkEm6EIEbR8z4oCUNgu7EJFEKVq6MKkbQSh5iMuWRAdHpZR5K3Ehzkzb0Zmpned3btKa8jIDQjZ6Ied+5zv3nXvOuefeAP+rkdy15EIL4EgQBI3NB/51ft8cXdvmG+viBqAFF8U2XFg7P9lm+UDT8cX6QL5HRq4SaAGMCDYD1TPdmqLOLTgQZHID6R4ZWyHQAhi7JuR4XWT/aFX6tTAupMPcP8yOP4i1ANq6novC3DbK1dvUkNKYClF9xHSdihZAzRfDeOjcjnnCbzlMHuU2I9OhUQvgmGAEjsj+EfQrYRy5Eeb6mIKiogV9C05supT9I/lnvxbGMX18Yf7OCXWIbMO9KZAMBBd/ocD57B6ZXstefu9sIzh7hjiSvd9QsB/v4K6JvWJEPHtfXPEUdVnt7/MlcvbExE9iA159CKeusDc3ibWQ6IlfWRXrzG9I8HhTp2E6GPlLKPN1N1F2MGutzyj8Loy1y01kKjxFX5RHPXzI+TkXL3Mi8Tmbk850DXuFHN24PL/7YbGaX/Dq+cDuKcxdx9iycO/TV1DCS9h4EFj0yJz4lSXo9E7xCJUTTIH5FFwaEb3OC8ZfVGqoBXCS+PwNsY7SYjuIMfjiGtr0zRZrshWacOyAYFGRkW3GCeSHJbJf8mbVAQbPUXSYw3Kvht1CijN2bE4ErXMeMj5gNFGrkoqzpGBTdfT951awpahyjPJL0Gy9zah1kWlAQwFyVVs+FS0Yk+DpNYpAWRe5vFEiZuQexQ4maEtT6c6R/hVncoJ6Jz4Hx3/kOiO48iJt6LaNxFbuUNOCiQpusUDJIP/zM71FpPR1aHPnxDo1SVgnNM27LydoSGHbVyc/mOKMQhAomRMSjcQ2zl9XwAoEZ/idIfmzk7r3ICn1Qa3CqKWpJHP9jmXq3YSiwpZ9ChnmvQFDoEX2ldgC96ZAXOPCMveXN5YNIIuo6dIWmKBuKnmkxsSJHNYoQVfJyVI95mRHHQRj+5aVPSflPUeuG3LDZ+5SDS7qnhpbzqxC3s+2k1Q64WLOqqLGPU9ydatip5HhvvLJGX7NOjMunltqFXuNdXwELRiP+LWCCt5N6uAXDL3DAiNPuagptkIp5uqsC57hoUincoLlaqKJNgFSU22pcZ0QNj/eeQ2OsQIHWrCL5GrIu3cJRwlSaetTTjE15uNpRlpCpKGi3X5aQpTx59gSijukqYz4AL7DVx5bQRECT8I4vGIoezWS5nYiPm5s/kBDrRKv4us04vt4aRQi+xCtJxltzMcLrfQhSRh4AguMdQ0H5Cq0SncwZP73Hmgi6sF8iws4jOx+3LMHeFa8ijAPXrhwkDjy5inWKj//GLGZz+8Xhev44OS9yBtM5DPimXyT8qn5u6Xp4u+UKGcn84rT8/OPiGloo/egDc1f2FHvQQsbhsO4POz6cFwN9iKPRkENtg2HLVYwe3o4rrbwkshO6h7bwvzfp/8GXz54NARdLSEAAAAASUVORK5CYII="> returns the area of the rectangle it represents.</li>
<li><img alt="\boldsymbol{\mathcal{H}}" class="math inline-math" style="vertical-align: -1px" height="13" width="18" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAaBAMAAADPgvgPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAEFSrze8iid27mWZ2MkR5GhjhAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAUlEQVQYGY2QPW4CMRCFx0LhZ2MhwglWygE2N9hmKVIgKEgfiYYOGmoo6ShygM0NSEXLtlQcIRwBIUDhR3qZGdsRZabwzHx+tt+Y6N9hnluHd1WPY3fITABMpR6g4VCCGbCTOj87EuGLVuhyY7B3aMF5qAet05JFQfSNF96v6sqCGzeJcNZueSVqyiMbbSZQ4pZUX5/7B5XNfziVcb1T4cKNxekP9dm9xjSgeiD4DCjKOuhl2WuOOCAxVHCzCEPLxsZ5OErtoyOGDO5slfUH6urEiyr6NY/gaY1HDxhxVWHz9s2jRG8v4fCUhpFy+R+qiePCq85bKSyTtichrT+WUv4CkXdxgR+uzWsAAAAASUVORK5CYII="> is a set containing all the rectangles of the same area such that there is no bigger rectangle contained under the same histogram (i.e. our result).</li>
</ul>
<h3 id="correct-solution">Correct solution</h3>
<p>The above model can be directly used to create a program. An implementation in haskell could look something like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource haskell numberLines"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1"></a>h <span class="ot">=</span> [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>]</span>
<span id="cb1-2"><a href="#cb1-2"></a>n <span class="ot">=</span> <span class="fu">length</span> h</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>allRectangles <span class="ot">=</span> [ (x,y) <span class="op">|</span> x <span class="ot">&lt;-</span> [<span class="dv">1</span><span class="op">..</span>n], y <span class="ot">&lt;-</span> [<span class="dv">1</span><span class="op">..</span>n], x <span class="op">&lt;</span> y ]</span>
<span id="cb1-5"><a href="#cb1-5"></a>allAreas <span class="ot">=</span> [ getArea r <span class="op">|</span> r <span class="ot">&lt;-</span> allRectangles ]</span>
<span id="cb1-6"><a href="#cb1-6"></a>maxArea <span class="ot">=</span> <span class="fu">maximum</span> allAreas</span>
<span id="cb1-7"><a href="#cb1-7"></a>results <span class="ot">=</span> [ r <span class="op">|</span> r <span class="ot">&lt;-</span> allRectangles, getArea r <span class="op">==</span> maxArea ]</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="ot">getArea ::</span> (<span class="dt">Int</span>, <span class="dt">Int</span>) <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>getArea (start, end) <span class="ot">=</span> <span class="kw">let</span> width <span class="ot">=</span> end <span class="op">-</span> start <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>                           subhistogram <span class="ot">=</span> (<span class="fu">take</span> width (<span class="fu">drop</span> (start <span class="op">-</span> <span class="dv">1</span>) h))</span>
<span id="cb1-12"><a href="#cb1-12"></a>                           height <span class="ot">=</span> <span class="fu">minimum</span> subhistogram</span>
<span id="cb1-13"><a href="#cb1-13"></a>                       <span class="kw">in</span> height <span class="op">*</span> width</span>
<span id="cb1-14"><a href="#cb1-14"></a>                       </span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">print</span> results</span></code></pre></div>
<p>This solution although clearly correct is very slow. The asymptotic complexity of this algorithm is <img alt="\mathcal{O}(n^2)" class="math inline-math" style="vertical-align: -5px" height="18" width="43" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAAAlBAMAAAAqzgOrAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMrtmEHbvzatUid0imUTrp4iQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACbUlEQVQ4Ea1UPW8TQRB9ts92bN/5LCo6n6BIEEhxRevrgkKRiIaOWGmi0NjiowLko6OLlQKKFDFSCqhsGhCKFK6ijSta8g8cAoQPQZaZ2b3znYMQRaaYefNm9m52dmeBs5MXszv/+7FsaL/2/5HshJPgS2DswQomTBpdTLjdGtxD4FmCwrmGdaN9XxgnSAQ++HC/AOUEd20dg12lPM7aYpWQ/SE5d2PCXgsX7mFR/WZmPaY1+NgjO/Yjdjyydgk3FTHlVsRqW/3KtjIybOYIxU9MqAbgLhvWmPfil6hoEapo0CeUU6SbPqGJ2Hsay9cJdmv2MTMZFQAPGE1koQb58GVN5Y7gvGJoqREg+4tzrSuAx94gZI3CDzGk1DKq4px/hNyTOR+4fufCbIfD4x5rbLfEALbqIf+LHCtY2rmEypDKU4p/BiyJxnyHHZKqCjHDG84fuKshnBNhtXI9se1Auyh/A4qH5GRRpx46cW1EFYaSxJ0SqXymHnOug2ZAy7jnkVRajGzulEid1moOGz06FV4WifyPOtUxxPxBnNv2ac+e4dnoXCizPsetlRqQocqx0eAkI+Z/XXN++wHxen3+J0G+SbGYvTWPhbRXOSA9Q5baVfqOxTgVpmcF9ZC5p33WZT4LmYWZE9xirMUdiS0pvoube+LoM653pHJP57Eem+K3lXrz7q3mLbk7K32qppUc6JXQxG+2155raO7kVYpYc48jjqy5kwmGYNNP+8a7/Td2eoZ0TjxDqSXTs6mDxSCVFDnTMy/8ZOajNLFbKc84+kk6FXGCU1TqjUpFk2+fCaTevmRy8gg0bwXJ+JnjP6oon5pqFANxAAAAAElFTkSuQmCC"> since the first list comprehension generates a set of pairs of all the numbers smaller than <img alt="n" class="math inline-math" style="vertical-align: -1px" height="9" width="11" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAASBAMAAACtCzMeAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMqvNmWa7EIlU3XZE7yJRVbUsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAiklEQVQIHWNgwAmETBhYlZIKQPLsCvXtmQxcC0Bs7gP81x4wsPwBsdkY5D8yMLD8BLFZGOIVGBiYgXwQ0J/AwMD/AcK+DzRjfgKYzfgZJBcAZnP/AFL/gXJAwAY0jvMTQwWIzf+dgYHpD8MeEFvegIGB6wNDAoi9vwEofoHlAYgdCyTZkxRBTOwAAHaZHiVu/7B+AAAAAElFTkSuQmCC"> and all the following operations are just folds over the resulting list which have the same complexity.</p>
<p>A solution of this type is still very valuable even if we don’t want to use it directly. A faster solution will likely result in code that is much harder to read and reason about. Having a slow-but-correct implemenation as the one above allows us to write faster implementations and compare their behaviour on a subset of all the possible inputs.</p>
<h3 id="faster-implementations">Faster implementations</h3>
<p>There are a few ways we can speed the program up according to the internet.</p>
<h4 id="divide-and-conquer">Divide and conquer</h4>
<p>Divide and conquer is an option which as usually results in an <img alt="\mathcal{O}(n \log(n))" class="math inline-math" style="vertical-align: -5px" height="18" width="81" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAAAkBAMAAAD4NfztAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMrtmEHbvzatUid0imUTrp4iQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAECklEQVRIDdVWPWwURxR+590739/eWalSRPIJGiMj4Qqlu5UbEI0tiqQLJyTkOAEOQYgLE3njJI47n1JA4cKOFJHSlyZRhJTbOg1XRgoSVyAaCoMBA07C5Pve7LG7dyc5RRqe5G+/982btzNv3txa5K00L/xPy74XR7kBuRsARtrRkeqgODaTUG4ptxjJ78y4Z5vX1fGCSLOP/PKFlN93/ugTPotBjGQipxdl544xNfJNQmyVk89jJ2aFdszBrqlnkbS8EJ76TM6Yf+gsEhLmjcyYayVCRHZ9uhaVdd07eNaNjw00qCSsODLj7UQEaKlL3yJIZk/Gn1AwqHZ1nmMJG51x4DWFZ5xhEeRuW3a28XQMsO6DJW1kRkczJMLsG/rvWZko73MwYwKR5USY0pEZx9sDYdPqWxRnT7yfKLgG1dDTSYYPZSw/QG0QmbKdkK5Fyb3qj5l5qajz7hfirE/5qmtG98fVY/QKR66+980HONUWnMy3XXl/9WuNUsHKIlsN1dBEpiXZv+G4wdwPx6Rkd6YZH7XkFKeuTVT+YseeC+Gcdg9mW8IuEZnTRVuUE1dUE6mYUPIsebZXPR+K91p1ZtSVo8JZ8Ptc3oYP+Ej2j8PvgUq1FqM0Azqw4guR8ccgYzKJbvJsNZgx14a6uy0lyFs18BX8SS1jJqI32IgIhT2jVnqKnmRGT+oBkrNH8R5k1OaqPpMqarLL7B2OdJ2XwBVkxbxGjGUT0IFNItaOyEYLG3msKjN25kFzTyXHNQbgP+tQnrswSnVvdofomSuqiZzovcnY9KPt2TXyMknpQNerdbQZcyh6YU9nJzOKsWsRh62ou5YMKiobTJPMiPFOWDmgqLuWSawlj1LBkruWFWyLdjcA2HdlOc34AJuxOQ+Sey7lr5ZWexT1ZOTcNmpj76OeXf9k6vs+g8rnido9MobGKbyUM1RYx/tdEByL06IC0+7RMm0F7jaEVPfkzA0G3eSAFNnh+uL8azQcFWSca4DgSIpcK81eN+5io5ftQbDXMrqcBcPCf/cb9KiXtUCoaI0KMxZYrM/x63SZCszeQla7g+6lgBR9xMuN+aXzKxVcQB6PFijf8ELyMTbdzRmZxf1wm8Ys3IOv102rvSb07bWMEHEfNhe+p0xbJpwMoU59SVpqmk/h/HlEP5FrS0tN/J6I/po5FzE+uz7BsGlChEpjqPsxH2IPW5A2cWxDv7ifaKzFgWlDX4Xk+CU6Wpio4/qDA1+FvqzPYiPlphxXu1s+hjjw5RoPGGiRLGWLKS/tTPvwHexaDvm6pqZtpry046Ejyrd7EAvt1Mh19SymBuh4wZAUC79Pra/zdEQO+S8lngL2//wnlUxpGzupjOTa2HbEDfh0A8DbYf8C/wk3eKXzaysAAAAASUVORK5CYII="> solution. This solution has the advantage that it can be parallelized. This can be handy if we get a really big histogram. We will assume the inputs are reasonably small and so we will focus on an <img alt="\mathcal{O}(n)" class="math inline-math" style="vertical-align: -5px" height="18" width="36" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAAAkBAMAAAA3NwprAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMrtmEHbvzatUid0imUTrp4iQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACGElEQVQ4EbVUPU8bQRB9ts82tu9slIrOlmhIhau0d10QDVYausSiQSiFXSQSUhL50qUDpUhDYUdKkQ5oEkUIcv8AfgL/gMRJyIeAYWb2vF4jHClFpph97+3s3u7bvQX+awTJePqlMbyB5h1e6joEd5reg85TVYLY7XjvkKUN7B4QNUTacXSg2LTUX0/uP8EyXYqyYWUB1e+Wnp14B0xCioBy28oKDkc0M0TxK5MK8fS11kg2bT9K+fEedgeMc8Q5jBg5YUf1Zv1z0TMUA8+cCoHZPSPkhgj2BXp0Alwa0ebyhYGF3yOJWqgqmXuB3KuFSHQjAP22MA6ftpGXoV688u4uKvotL518sSslHFVKMCP+5E9rawmCK1WHmtGJTYvyT/b6C5Ms6uxMYFby2PTK/jUq39gzqQoQxjxAPAQ+aPZl/xp1XkilrXBrm/2VAUBPs0ddbYHFU1vViXhXDdVNFciMQU52o19EhleIraZWmS+i90MZjmNudfXI/2FIEScgXX14rtRfE02dQJZNKP3CsiipEwV6LuzNQLI5kBq7NnOFh6KkrpZIbszrI5HSA6nzhniFDRHYHo0+0cfPnww2B/JowHO1g4Q1PTLp81Y7628FSOjNuZewuvBS+OjmCB5HGI2xoMJgkhtm72ba2Y9uq7r5d2zeVvSXP22ifGeCFVsT1JLpL4AtETD9NXHL1MxUmP4yuSP+CV8DqBmJEt5ym3AAAAAASUVORK5CYII="> implementation that, though constrained to be run sequentially, is faster and more memory efficient. The modern hardware can then be leveraged by solving multiple histograms in parallel.</p>
<h4 id="the-incomplete-problems-algorithm">The “Incomplete problems” algorithm</h4>
<p>The idea is quite verbously described <a href="http://www.informatik.uni-ulm.de/acm/Locals/2003/html/judge.html">here</a>. From the amount of text it might seem like a complicated algorithm but it’s an exceptionaly nice one actually. The following widget illustrates its progress.</p>
<div style="text-align: center">
<div id="histogram-widget" style="display: inline-block">

</div>
</div>
<script>
    requirejs(["./histogramPlayground"], function(histogram) {
        var React = histogram.React,
            HistogramPlayground = histogram.HistogramPlayground;

        var container = document.getElementById("histogram-widget");
        var playground = React.createElement(HistogramPlayground, {});

        React.render(playground, container);
    });
</script>
<p>The algorithm makes use of a stack and simply moves over the histogram from left to right. Every time we encounter a column higher than the one we have on top of the stack we push it to the stack since it is the potential start of a rectangle (1. new arrow). A column of the same size as the top of the stack just means that all the rectangles in the stack can be one bar wider (2. arrow crosses to next bar). A column smaller than the top signals the end of a rectangle (3. this is where the arrows disappear in the above widget).</p>
<p>Each iteration falls into one of these cases:</p>
<ol type="1">
<li>the height is bigger than the one on top of the stack or the stack is empty</li>
<li>the height is equal to the one on top of the stack</li>
<li>the height is smaller than the one on top of the stack</li>
</ol>
<p>Haskell implementation:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource haskell numberLines"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1"></a>h <span class="ot">=</span> [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>]</span>
<span id="cb2-2"><a href="#cb2-2"></a>n <span class="ot">=</span> <span class="fu">length</span> h</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>(maxArea', stack') <span class="ot">=</span> <span class="fu">foldr</span> stepFn (<span class="dv">0</span>, []) h</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="ot">stepFn ::</span> (<span class="dt">Int</span>, [(<span class="dt">Int</span>, <span class="dt">Int</span>)]) <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>) <span class="ot">-&gt;</span> (<span class="dt">Int</span>, [<span class="dt">Int</span>])</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">-- CASE 1</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>stepFn (curMax, stack<span class="op">@</span>[]) (i, x) <span class="ot">=</span> (curMax, [(i, x)])</span>
<span id="cb2-9"><a href="#cb2-9"></a>stepFn (curMax, stack<span class="op">@</span>((topIndex, topHeight)<span class="op">:</span>rest)) (i, x) <span class="op">|</span> x <span class="op">&gt;</span> topHeight <span class="ot">=</span> (curMax, (i, x)<span class="op">:</span>stack)</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">-- CASE 2</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>stepFn (curMax, stack<span class="op">@</span>((topIndex, topHeight)<span class="op">:</span>rest)) (i, x) <span class="op">|</span> x <span class="op">==</span> topHeight <span class="ot">=</span> (curMax, stack)</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">-- CASE 3</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>stepFn (curMax, stack<span class="op">@</span>((topIndex, topHeight)<span class="op">:</span>rest)) (i, x) <span class="op">|</span> x <span class="op">&lt;</span> topHeight <span class="ot">=</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="kw">let</span> biggerElements <span class="ot">=</span> <span class="fu">takeWhile</span> (\(_, y) <span class="ot">-&gt;</span> y <span class="op">&gt;</span> x) stack</span>
<span id="cb2-15"><a href="#cb2-15"></a>        curMax' <span class="ot">=</span> <span class="fu">foldr</span> (\(curMax, (j, y)) <span class="ot">-&gt;</span> <span class="fu">max</span> curMax ((i <span class="op">-</span> j) <span class="op">*</span> y)) curMax biggerElements</span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="kw">in</span> (curMax', rest)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="fu">print</span> results</span></code></pre></div>
<p>Seeing our implementation it might be clear why it is called the “Incomplete problems” algorithm. In case 1 we just push open rectangles representing potential solutions on the stack which we expand in case 2 and close in case 3.</p>
<h5 id="testing-it">Testing it</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource haskell numberLines"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">module</span> <span class="dt">Main</span> (main) <span class="kw">where</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">import</span> <span class="dt">Test.Hspec</span> (describe, it, hspec, shouldBe)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">import</span> <span class="dt">Test.QuickCheck</span> (<span class="dt">Gen</span>, sized, choose, forAll, (==&gt;))</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">import</span> <span class="dt">Data.List</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">import</span> <span class="dt">Control.Monad</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">import</span> <span class="dt">Histogram</span> (histogramCorrect, histogramFast)</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">-- we define a histogram generator that accepts the width of the histogram as the argument `n`</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="ot">histograms ::</span> <span class="dt">Gen</span> [<span class="dt">Int</span>]</span>
<span id="cb3-13"><a href="#cb3-13"></a>histograms <span class="ot">=</span> sized <span class="op">$</span> \n <span class="ot">-&gt;</span> <span class="fu">mapM</span> (<span class="fu">const</span> <span class="op">$</span> choose (<span class="dv">0</span>, <span class="dv">100</span>)) [<span class="dv">1</span><span class="op">..</span>n] <span class="co">-- it generates a histogram of `n` columns of height ranging from 0 to 100</span></span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb3-16"><a href="#cb3-16"></a>main <span class="ot">=</span> hspec <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a>  describe <span class="st">&quot;Histogram&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a>    it <span class="st">&quot;Quickcheck comparison&quot;</span> <span class="op">$</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>      forAll histograms <span class="op">$</span> \xs <span class="ot">-&gt;</span> (<span class="fu">not</span> <span class="op">$</span> <span class="fu">all</span> (<span class="op">==</span><span class="dv">0</span>) xs) <span class="op">==&gt;</span> <span class="co">-- pick random histograms but skip the ones of all zeroes</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>        <span class="fu">sort</span> (histogramCorrect xs) <span class="op">==</span> <span class="fu">sort</span> (histogramFast xs) <span class="co">-- the results of the two implementations should always match</span></span></code></pre></div>
<p>Running the tests through <code>cabal test --show-details=direct --test-option=--maximum-generated-tests=10000</code> gives us</p>
<pre class="console-output">
Running 1 test suites...
Test suite histogram-testsuite: RUNNING...

Histogram
Quickcheck comparison

Finished in 13.6331 seconds
1 example, 0 failures
Test suite histogram-testsuite: PASS
Test suite logged to: dist/test/histogram-0.1.0.0-histogram-testsuite.log
1 of 1 test suites (1 of 1 test cases) passed.
</pre>
<p>This generated 10000 histograms of various sizes, ran both the algorithms on them and compared their outputs. The <code>--show-details=direct</code> tells cabal to directly attach the testing framework to the terminal so you can actually see the count of how many instances we already tested live updated in the terminal (it also allows it to use terminal colors).</p>
<h3 id="performance">Performance</h3>
<p><strong>TODO</strong></p>
<h3 id="code">Code</h3>
<ul>
<li><a href="//github.com/fghibellini/max-area-under-histogram">haskell code</a></li>
<li><a href="//github.com/fghibellini/max-area-under-histogram-vizualization">React widget</a></li>
</ul>
<h3 id="links-to-solutions">Links to solutions</h3>
<ul>
<li><a href="http://stackoverflow.com/questions/4311694/maximize-the-rectangular-area-under-histogram#answer-4690790">Stack overflow answer in python</a></li>
<li><a href="http://www.informatik.uni-ulm.de/acm/Locals/2003/html/judge.html">Programming Contest University of Ulm Local Contest</a></li>
</ul>
<h3 id="more-on-quickcheck">More on Quickcheck</h3>
<ul>
<li><a href="//www.stuartgunter.org/posts/intro-to-quickcheck/">intro-to-quickcheck</a></li>
<li><a href="//www.eecs.northwestern.edu/~robby/courses/395-495-2009-fall/quick.pdf">the original paper</a></li>
<li><a href="//begriffs.com/posts/2017-01-14-design-use-quickcheck.html">longer tutorial</a> - shows how to run QuickCheck without Hspec</li>
</ul>

            <div class="comments">
                <h2>Comments</h2>
                <div id="disqus_thread"></div>
                <script>
                /**
                *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
                var disqus_config = function () {
                    this.page.url = "http://fghibellini.com";  // Replace PAGE_URL with your page's canonical URL variable
                    this.page.identifier = "/posts/2015-06-26-Max-area-under-histogram/index.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://fghibellini.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>

        </div>

        <!-- SHARED FOOTER ACROSS PAGES -->
<div class="footer">
    <div class="generated-by">
        generated by
        <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        <img src="../../images/haskell-logo.png" class="hakyll-img" />
    </div>
    <div class="copyright">© 2017 Filippo Ghibellini. All rights reserved.</div>
    <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-105665099-1', 'auto');
          ga('send', 'pageview');
    </script>
</div>

    </body>
</html>
